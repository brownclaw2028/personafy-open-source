# =============================================================================
# Personafy — Environment Variables
# =============================================================================
# Copy this file to .env.local and fill in your values.
#
#   cp .env.example .env.local
#
# NEVER commit .env.local — it is git-ignored via the *.local and .env.* rules.
# =============================================================================

# -----------------------------------------------------------------------------
# Supabase — Server-side (API handlers in apps/web/api/)
# -----------------------------------------------------------------------------

# Your Supabase project URL (Settings > API > Project URL)
SUPABASE_URL=https://your-project.supabase.co

# Public anonymous key — safe for client-side use (Settings > API > anon/public)
SUPABASE_ANON_KEY=your-anon-key-here

# Service-role key — has full admin access. NEVER expose to the client.
# Used by API handlers for admin operations (user creation, device management).
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# -----------------------------------------------------------------------------
# Supabase — Client-side (Vite injects these into the browser bundle)
# -----------------------------------------------------------------------------

# These must match the server-side values above for the same Supabase project.
# Vite requires the VITE_ prefix to expose variables to client code.
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here

# -----------------------------------------------------------------------------
# Cloud provider rollout flags (Phase 0 migration controls)
# -----------------------------------------------------------------------------
#
# Default posture:
# - Keep Supabase sync as baseline
# - Keep cloud backup OFF unless user opts in
# - Enable Hippius only behind explicit flags
#
# Allowed values:
#   VITE_CLOUD_MIGRATION_MODE=supabase-only|coexist|hippius-only
#   VITE_CLOUD_BACKUP_PROVIDER=supabase|hippius
VITE_CLOUD_MIGRATION_MODE=supabase-only
VITE_CLOUD_BACKUP_PROVIDER=supabase
VITE_ENABLE_HIPPIUS_BACKUP=false
VITE_CLOUD_BACKUP_DEFAULT_ON=false

# Server-side provider routing for API handlers
# Keep sync on Supabase for coexist rollout in Phase 2.
CLOUD_SYNC_PROVIDER=supabase
CLOUD_BACKUP_PROVIDER=supabase

# -----------------------------------------------------------------------------
# Hippius (server-side only; optional cloud backup provider)
# -----------------------------------------------------------------------------
# Access key IDs should start with `hip_`.
HIPPIUS_ACCESS_KEY_ID=hip_your_access_key_id_here
HIPPIUS_SECRET_ACCESS_KEY=your_hippius_secret_access_key_here
HIPPIUS_BUCKET=personafy-encrypted-backups
# RPC URL is currently pending confirmation from Hippius API docs/support.
HIPPIUS_RPC_URL=https://your-hippius-rpc-endpoint.example
# Optional: bearer token if your RPC endpoint is protected.
HIPPIUS_RPC_AUTH_TOKEN=
# Optional: comma-separated usage methods to probe in order.
HIPPIUS_USAGE_RPC_METHODS=storage_getUsage,getStorageUsage,usage_get
# Optional pricing assumptions for monthly cost estimates.
HIPPIUS_STORAGE_PRICE_PER_GB_MONTH_USD=0.00
HIPPIUS_REQUEST_PRICE_PER_1000_USD=0.00

# -----------------------------------------------------------------------------
# PostHog Cloud (optional — analytics + session replay)
# -----------------------------------------------------------------------------

# PostHog project API key (Settings > Project > API Key)
# Enables event analytics, funnels, and session replay when set.
VITE_POSTHOG_KEY=phc_your_project_api_key_here
POSTHOG_API_KEY=phc_your_project_api_key_here

# -----------------------------------------------------------------------------
# Semantic extraction (WebGPU-based, experimental)
# -----------------------------------------------------------------------------

# Enable WebGPU-based semantic extraction (requires compatible browser/GPU)
VITE_SEMANTIC_WEBGPU_ENABLED=false

# WebGPU model path for semantic extraction (e.g. Qwen2.5-0.5B-Instruct-q4f16_1-MLC)
VITE_SEMANTIC_WEBGPU_MODEL=

# Semantic extraction rollout mode: off | shadow | active
#   off    — disabled entirely (default)
#   shadow — runs in background, results logged but not used
#   active — results used in production extraction pipeline
VITE_SEMANTIC_ROLLOUT_MODE=off

# =============================================================================
# CI / GitHub Actions Secrets
# =============================================================================
# The following secrets must be configured in GitHub repository settings
# (Settings > Secrets and variables > Actions) for CI workflows to work:
#
#   SUPABASE_URL              — Used by nightly.yml live-e2e job
#   SUPABASE_ANON_KEY         — Used by nightly.yml live-e2e job
#   SUPABASE_SERVICE_ROLE_KEY — Used by nightly.yml live-e2e job
#
# These are the same values as above. They are injected as environment
# variables into the "Live Supabase E2E" job in .github/workflows/nightly.yml.
#
# The fast PR gate (ci.yml) does NOT require Supabase secrets — it only
# runs mocked unit tests and Playwright E2E against the local dev server.
# =============================================================================
